<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webGL相关问题 | crithesJie的博客文档</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="crithesJie">
    
    <link rel="preload" href="/gaojieDoc/assets/css/0.styles.9e6fc204.css" as="style"><link rel="preload" href="/gaojieDoc/assets/js/app.713b364e.js" as="script"><link rel="preload" href="/gaojieDoc/assets/js/3.cbaeffb4.js" as="script"><link rel="preload" href="/gaojieDoc/assets/js/1.790136b1.js" as="script"><link rel="preload" href="/gaojieDoc/assets/js/14.b3bbe717.js" as="script"><link rel="prefetch" href="/gaojieDoc/assets/js/10.78eb5da3.js"><link rel="prefetch" href="/gaojieDoc/assets/js/11.2b3109aa.js"><link rel="prefetch" href="/gaojieDoc/assets/js/12.3210027b.js"><link rel="prefetch" href="/gaojieDoc/assets/js/13.7b55b15e.js"><link rel="prefetch" href="/gaojieDoc/assets/js/15.f36d7504.js"><link rel="prefetch" href="/gaojieDoc/assets/js/16.8239258f.js"><link rel="prefetch" href="/gaojieDoc/assets/js/17.549936e2.js"><link rel="prefetch" href="/gaojieDoc/assets/js/18.845d5e64.js"><link rel="prefetch" href="/gaojieDoc/assets/js/19.cf758925.js"><link rel="prefetch" href="/gaojieDoc/assets/js/20.bf61bf13.js"><link rel="prefetch" href="/gaojieDoc/assets/js/21.0fdc80ec.js"><link rel="prefetch" href="/gaojieDoc/assets/js/22.c6ecb104.js"><link rel="prefetch" href="/gaojieDoc/assets/js/23.27223034.js"><link rel="prefetch" href="/gaojieDoc/assets/js/24.31e80cd9.js"><link rel="prefetch" href="/gaojieDoc/assets/js/25.5aca483f.js"><link rel="prefetch" href="/gaojieDoc/assets/js/26.6e3a0bc0.js"><link rel="prefetch" href="/gaojieDoc/assets/js/27.0ff0e880.js"><link rel="prefetch" href="/gaojieDoc/assets/js/28.60c3de8c.js"><link rel="prefetch" href="/gaojieDoc/assets/js/29.1c1245a3.js"><link rel="prefetch" href="/gaojieDoc/assets/js/30.98fa33c7.js"><link rel="prefetch" href="/gaojieDoc/assets/js/31.2b96c834.js"><link rel="prefetch" href="/gaojieDoc/assets/js/32.459e0b9d.js"><link rel="prefetch" href="/gaojieDoc/assets/js/33.b9b3a632.js"><link rel="prefetch" href="/gaojieDoc/assets/js/34.90598a5b.js"><link rel="prefetch" href="/gaojieDoc/assets/js/35.7c81a08a.js"><link rel="prefetch" href="/gaojieDoc/assets/js/36.5188b8e2.js"><link rel="prefetch" href="/gaojieDoc/assets/js/37.7992bccd.js"><link rel="prefetch" href="/gaojieDoc/assets/js/38.37608ee8.js"><link rel="prefetch" href="/gaojieDoc/assets/js/39.486b92ce.js"><link rel="prefetch" href="/gaojieDoc/assets/js/4.2eaf2991.js"><link rel="prefetch" href="/gaojieDoc/assets/js/40.acaf08c5.js"><link rel="prefetch" href="/gaojieDoc/assets/js/41.a99b805b.js"><link rel="prefetch" href="/gaojieDoc/assets/js/5.db0b541d.js"><link rel="prefetch" href="/gaojieDoc/assets/js/6.4f171289.js"><link rel="prefetch" href="/gaojieDoc/assets/js/7.eb05470f.js"><link rel="prefetch" href="/gaojieDoc/assets/js/8.db3ae41e.js"><link rel="prefetch" href="/gaojieDoc/assets/js/9.abb40ed3.js">
    <link rel="stylesheet" href="/gaojieDoc/assets/css/0.styles.9e6fc204.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-130b300a><div data-v-130b300a><div class="password-shadow password-wrapper-out" style="display:none;" data-v-25ba6db2 data-v-130b300a data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2>crithesJie的博客文档</h3> <p class="description" data-v-25ba6db2 data-v-25ba6db2>crithesJie</p> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-130b300a><header class="navbar" data-v-130b300a><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/gaojieDoc/" class="home-link router-link-active"><!----> <span class="site-name">crithesJie的博客文档</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/gaojieDoc/handbook/ConditionalTypes.html" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><a href="https://github.com/crithes" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/gao-jie-test" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/gaojieDoc/aboutme/index.html" class="nav-link"><i class="undefined"></i>
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-130b300a></div> <aside class="sidebar" data-v-130b300a><div class="personal-info-wrapper" data-v-39576ba9 data-v-130b300a><!----> <!----> <div class="num" data-v-39576ba9><div data-v-39576ba9><h3 data-v-39576ba9>30</h3> <h6 data-v-39576ba9>文章</h6></div> <div data-v-39576ba9><h3 data-v-39576ba9>0</h3> <h6 data-v-39576ba9>标签</h6></div></div> <ul class="social-links" data-v-39576ba9></ul> <hr data-v-39576ba9></div> <nav class="nav-links"><div class="nav-item"><a href="/gaojieDoc/handbook/ConditionalTypes.html" class="nav-link"><i class="undefined"></i>
  首页
</a></div><div class="nav-item"><a href="https://github.com/crithes" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/gao-jie-test" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/gaojieDoc/aboutme/index.html" class="nav-link"><i class="undefined"></i>
  关于我
</a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开发问题总结</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/gaojieDoc/git/git.html" class="sidebar-link">git相关</a></li><li><a href="/gaojieDoc/api/api.html" class="sidebar-link">常用数据处理Api</a></li><li><a href="/gaojieDoc/personal/personal.html" class="sidebar-link">个人作品</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>webGL相关</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/gaojieDoc/webGL/webGL.html" aria-current="page" class="active sidebar-link">WebGL相关</a></li><li><a href="/gaojieDoc/webGL/3d.html" class="sidebar-link">3d相关</a></li><li><a href="/gaojieDoc/webGL/threejs.html" class="sidebar-link">threejs</a></li><li><a href="/gaojieDoc/webGL/cesium.html" class="sidebar-link">cesium</a></li><li><a href="/gaojieDoc/webGL/webGLBasics.html" class="sidebar-link">WebGL基础</a></li></ul></section></li><li><a href="/gaojieDoc/lowcode/lowcode.html" class="sidebar-link">低代码</a></li><li><a href="/gaojieDoc/mianshi/mianshi.html" class="sidebar-link">面试常见</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/gaojieDoc/vue/vuex" class="sidebar-heading clickable"><span>vue相关</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/gaojieDoc/mac/mac.html" class="sidebar-link">mac相关问题</a></li><li><a href="/gaojieDoc/map/map.html" class="sidebar-link">地图相关</a></li><li><a href="/gaojieDoc/sourceCode/sourceCode.html" class="sidebar-link">源码系列</a></li><li><a href="/gaojieDoc/personal/skillArticle.html" class="sidebar-link">技巧文章</a></li><li><a href="/gaojieDoc/webpack/webpack.html" class="sidebar-link">webpack相关</a></li><li><a href="/gaojieDoc/deep/deep.html" class="sidebar-link">程序员底层相关</a></li><li><a href="/gaojieDoc/algorithm/algorithm.html" class="sidebar-link">算法相关</a></li><li><a href="/gaojieDoc/principle/principle.html" class="sidebar-link">原理相关</a></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-25ba6db2 data-v-130b300a><h3 class="title" data-v-25ba6db2 data-v-25ba6db2></h3> <!----> <label id="box" class="inputBox" data-v-25ba6db2 data-v-25ba6db2><input type="password" value="" data-v-25ba6db2> <span data-v-25ba6db2>Konck! Knock!</span> <button data-v-25ba6db2>OK</button></label> <div class="footer" data-v-25ba6db2 data-v-25ba6db2><span data-v-25ba6db2><i class="iconfont reco-theme" data-v-25ba6db2></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-25ba6db2>vuePress-theme-reco</a></span> <span data-v-25ba6db2><i class="iconfont reco-copyright" data-v-25ba6db2></i> <a data-v-25ba6db2><!---->
            
          <!---->
          2022
        </a></span></div></div> <div data-v-130b300a><main class="page"><section><div class="page-title"><h1 class="title">webGL相关问题</h1> <div data-v-f875f3fc><!----> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default"><h1 id="webgl相关问题"><a href="#webgl相关问题" class="header-anchor">#</a> webGL相关问题</h1> <h2 id="_1-参数vertexshader和fragmentshader分别对应顶点着色器和片段着色器的内容-由glsl写成-区别"><a href="#_1-参数vertexshader和fragmentshader分别对应顶点着色器和片段着色器的内容-由glsl写成-区别" class="header-anchor">#</a> 1.参数vertexShader和fragmentShader分别对应顶点着色器和片段着色器的内容（由GLSL写成）区别？</h2> <ul><li>使用HLSL语言编写</li> <li>顶点着色器的功能是把原始顶点数据变换到裁减空间坐标。每个顶点都会调用该着色器函数</li> <li>顶点着色器的输入数据有如下2种方式： Attributes (从缓存中获取的数据)，Uniforms (单次绘制中对所有顶点保持不变的值)</li> <li>顶点着色器的输出数据经过光栅化处理后，输入给片段着色器，而片段着色器的功能就是为正在光栅化的当前像素提供颜色</li> <li>每个像素都会调用片段着色器。片段着色器的输入数据有如下3种方式： Uniforms (对于单个绘图调用的每个像素保持相同的值，同上)，Textures (从像素pixels和纹元texels中读取的数据)，Varyings (从顶点着色器传递并插值的数据)</li> <li>变量（Varyings）是一种将值从顶点着色器传递到片段着色器的方法</li></ul> <h2 id="_2-fbx模型里面有啥-模型是如何加载到网页并显示出来的"><a href="#_2-fbx模型里面有啥-模型是如何加载到网页并显示出来的" class="header-anchor">#</a> 2.fbx模型里面有啥？模型是如何加载到网页并显示出来的？</h2> <ul><li>fbx模型返回数据</li></ul> <p><img src="/gaojieDoc/assets/img/img_13.851af4cf.png" alt="Image Text"></p> <ul><li>加载模型：使用load加载模型，add将模型添加到场景</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name">FBXLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>
      <span class="token string">&quot;./resources/models/building.FBX&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        _Global<span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 显示模型</span>
        <span class="token function">makeShadow</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li>显示模型：使用traverse方法，让castShadow和receiveShadow变为true</li> <li>traverse方法,通过在递归遍历中访问每个节点来遍历和变换对象</li> <li>因为阴影要投射到“地面”上，所以“地面”这个物体的receiveShadow属性为true；</li> <li>因为想要物体要产生阴影，那么该物体的castShadow属性为true</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">makeShadow</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  obj<span class="token punctuation">.</span><span class="token function">traverse</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">c</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span>isMesh<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      c<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      c<span class="token punctuation">.</span>receiveShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_3-如何让3d模型只能在上一半旋转"><a href="#_3-如何让3d模型只能在上一半旋转" class="header-anchor">#</a> 3.如何让3d模型只能在上一半旋转？</h2> <ul><li>设置最大仰角</li> <li>_Global.orbit.maxPolarAngle = Math.PI * 0.45; // 最大仰角</li></ul> <h2 id="_4-加载3d的音频文件时-内容不显示"><a href="#_4-加载3d的音频文件时-内容不显示" class="header-anchor">#</a> 4.加载3d的音频文件时，内容不显示？</h2> <ul><li>audio加个controls</li></ul> <h2 id="_5-3d的video没法播发http和m3u8-常见video解决方案"><a href="#_5-3d的video没法播发http和m3u8-常见video解决方案" class="header-anchor">#</a> 5.3d的video没法播发http和m3u8，常见video解决方案</h2> <ul><li>JSMpeg,EasyPlayer.js,ckplayer</li></ul> <h2 id="_6-3d的audio加载格式及问题"><a href="#_6-3d的audio加载格式及问题" class="header-anchor">#</a> 6.3d的audio加载格式及问题？</h2> <ul><li>加载常见格式：ogg,mp3,wav</li> <li>可视化音效，AudioAnalyser，傅里叶变换</li> <li>注意：getFrequencyData不能在load中，也不能在当前点击播放函数中，必须在render中通过requestAnimationFrame循环调用，analyser必须为全局变量</li></ul> <h2 id="_7-audio让模型发声-远声音小-近声音大如何实现"><a href="#_7-audio让模型发声-远声音小-近声音大如何实现" class="header-anchor">#</a> 7.audio让模型发声，远声音小，近声音大如何实现？</h2> <ul><li>使用PositionalAudio—位置音频</li> <li>setDirectionalCone—设置向某一个方向发声—设置方向线—这个方法用来把环绕声音转换为定向声音</li></ul> <h2 id="_8-3d视频如何加载的"><a href="#_8-3d视频如何加载的" class="header-anchor">#</a> 8.3d视频如何加载的？</h2> <ul><li>创建video元素，传入mp4视频</li> <li>使用VideoTexture--视频纹理</li> <li>在视频纹理内传入dom元素</li> <li>创建Mesh对象，将网格和贴图传入，视频纹理为贴图的map属性</li> <li>将Mesh对象加入场景中</li></ul> <h2 id="_9-常用2d和3d技术"><a href="#_9-常用2d和3d技术" class="header-anchor">#</a> 9.常用2d和3d技术</h2> <ul><li>2d:leaflet--https://leafletjs.com/</li> <li>3d:three和cesium</li></ul> <h2 id="_10-常见坐标系"><a href="#_10-常见坐标系" class="header-anchor">#</a> 10.常见坐标系</h2> <ul><li>火星—gcj-02—高德</li> <li>百度—bd-09</li> <li>地理gps—wgs84</li> <li>国标2000—cgcs2000</li></ul> <h2 id="_11-常见点位操作"><a href="#_11-常见点位操作" class="header-anchor">#</a> 11.常见点位操作</h2> <ul><li>地图点拾取：https://lbs.amap.com/tools/picker—高德</li> <li>坐标系转换：<a href="http://www.giscalculator.com/enter_coordpicker/" target="_blank" rel="noopener noreferrer">http://www.giscalculator.com/enter_coordpicker/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_12-常用地图数据和3d模型处理工具"><a href="#_12-常用地图数据和3d模型处理工具" class="header-anchor">#</a> 12.常用地图数据和3d模型处理工具</h2> <ul><li>arcgis,qgis,cad，3dmax</li></ul> <h2 id="_13-模型来源"><a href="#_13-模型来源" class="header-anchor">#</a> 13.模型来源</h2> <ul><li>无人机</li> <li>自己建立</li> <li>网上寻找</li> <li>200多页免费3d模型 <a href="https://link.juejin.cn/?target=https://www.turbosquid.com" target="_blank" rel="noopener noreferrer">www.turbosquid.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>免费3D雕像: <a href="https://link.juejin.cn/?target=https://threedscans.com" target="_blank" rel="noopener noreferrer">threedscans.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>免费3D模型：<a href="https://link.juejin.cn/?target=https://free3d.com" target="_blank" rel="noopener noreferrer">free3d.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_14-3dtiles模型文件是怎么样的-模型是如何加载加载出来的"><a href="#_14-3dtiles模型文件是怎么样的-模型是如何加载加载出来的" class="header-anchor">#</a> 14.3dtiles模型文件是怎么样的？模型是如何加载加载出来的？</h2> <ul><li>.b3dm文件记录了模型信息，tileset.json则记录了模型的地理位置、.b3dm文件的路径、与其他子瓦片的关系</li> <li>依靠tileset.json文件，粗糙的模型和细节模型建立了联结</li> <li>加载粗糙模型之后cesium会自动遍历tileset.json文件中的children项，加载children中声明的细节模型</li> <li>并通过refine（值为ADD或REPLACE）参数决定自身替换原模型或叠加在原模型上</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// tileset.js文件结构</span>
  <span class="token string-property property">&quot;asset&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;tilesetVersion&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0-obj23dtiles&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;geometricError&quot;</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;root&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;boundingVolume&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;region&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token number">1.9812667196223426</span><span class="token punctuation">,</span>
        <span class="token number">0.3977279931116791</span><span class="token punctuation">,</span>
        <span class="token number">1.98161901607411</span><span class="token punctuation">,</span>
        <span class="token number">0.39801077589267914</span><span class="token punctuation">,</span>
        <span class="token operator">-</span><span class="token number">11.305000305175781</span><span class="token punctuation">,</span>
        <span class="token number">134.83670043945312</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;refine&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ADD&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;geometricError&quot;</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;children&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;boundingVolume&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;region&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token number">1.9814442514794284</span><span class="token punctuation">,</span>
            <span class="token number">0.39777419936273345</span><span class="token punctuation">,</span>
            <span class="token number">1.9815212909274045</span><span class="token punctuation">,</span>
            <span class="token number">0.3978240929187335</span><span class="token punctuation">,</span>
            <span class="token operator">-</span><span class="token number">3.1728999614715576</span><span class="token punctuation">,</span>
            <span class="token number">98.01309967041016</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;geometricError&quot;</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;refine&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ADD&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;content&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Batchedbhyc/tileset.json&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
 <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="_15-导出瓦片文件指令是什么-常见配置项有那些"><a href="#_15-导出瓦片文件指令是什么-常见配置项有那些" class="header-anchor">#</a> 15.导出瓦片文件指令是什么？常见配置项有那些？</h2> <ul><li>obj23dtiles -i model.obj --tileset -p customTilesetOptions.json</li> <li>customTilesetOptions.json为配置文件，可以指定导出文件的坐标、离地高度、外包体信息</li></ul> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;longitude&quot;</span><span class="token operator">:</span>      <span class="token number">-1.31968</span><span class="token punctuation">,</span>     <span class="token comment">// 瓦片原点(模型原点 (0,0,0)) 经度的弧度值。</span>
    <span class="token property">&quot;latitude&quot;</span><span class="token operator">:</span>       <span class="token number">0.698874</span><span class="token punctuation">,</span>     <span class="token comment">// 瓦片原点维度的弧度值。</span>
    <span class="token property">&quot;transHeight&quot;</span><span class="token operator">:</span>    <span class="token number">0.0</span><span class="token punctuation">,</span>          <span class="token comment">// 瓦片原点所在高度，单位为米。</span>
    <span class="token property">&quot;region&quot;</span><span class="token operator">:</span>         <span class="token boolean">true</span><span class="token punctuation">,</span>         <span class="token comment">// 使用 region 作为外包体。</span>
    <span class="token property">&quot;box&quot;</span><span class="token operator">:</span>            <span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token comment">// 使用 box 作为外包体。</span>
    <span class="token property">&quot;sphere&quot;</span><span class="token operator">:</span>         <span class="token boolean">false</span>         <span class="token comment">// 使用 sphere 作为外包体。</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_16-第一人称和第三人称视角是什么-three中如何实现的"><a href="#_16-第一人称和第三人称视角是什么-three中如何实现的" class="header-anchor">#</a> 16.第一人称和第三人称视角是什么？three中如何实现的？</h2> <ul><li>第一人称—自己/个人/主角—最大限度沉浸感—个人开枪</li> <li>第三人称—旁观者/别人/观众—视野开阔—视野+个人</li> <li>所有的运动都是矩阵变化(物体移动的原理)</li> <li>前—负z,左—负x</li></ul> <p><img src="/gaojieDoc/assets/img/img_14.543004cf.png" alt="Image Text"></p> <h2 id="_17-人物移动如何实现"><a href="#_17-人物移动如何实现" class="header-anchor">#</a> 17.人物移动如何实现？</h2> <ul><li>使用new THREEx.KeyboardState()—获取键盘点击事件</li> <li>前：keyboard.pressed(&quot;down&quot;)—前—负z—box.translateZ(5 * new THREE.Clock().getDelta())</li> <li>向上旋转：keyboard.pressed(&quot;w&quot;)—box.rotateOnAxis( new THREE.Vector3(1,0,0), Math.PI / 2 * new THREE.Clock().getDelta()</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">THREE</span> <span class="token keyword">from</span> <span class="token string">'../../source/three.module.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> OrbitControls <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../source/OrbitControls.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> THREEx <span class="token keyword">from</span> <span class="token string">&quot;./keyboardState.js&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// 小滑块</span>
<span class="token keyword">const</span> boxgeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BoxGeometry</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> boxMaterials <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> boxMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">color</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">0xffffff</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    boxMaterials<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>boxMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 小块</span>
<span class="token keyword">const</span> box <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>boxgeometry<span class="token punctuation">,</span> boxMaterials<span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token comment">// 控制代码</span>
<span class="token keyword">const</span> keyboard <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREEx<span class="token punctuation">.</span>KeyboardState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> clock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">tick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token keyword">const</span> delta <span class="token operator">=</span> clock<span class="token punctuation">.</span><span class="token function">getDelta</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> moveDistance <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> delta<span class="token punctuation">;</span>
    <span class="token keyword">const</span> rotateAngle <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> delta<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>keyboard<span class="token punctuation">.</span><span class="token function">pressed</span><span class="token punctuation">(</span><span class="token string">&quot;down&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span><span class="token function">translateZ</span><span class="token punctuation">(</span>moveDistance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>keyboard<span class="token punctuation">.</span><span class="token function">pressed</span><span class="token punctuation">(</span><span class="token string">&quot;up&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span><span class="token function">translateZ</span><span class="token punctuation">(</span><span class="token operator">-</span>moveDistance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>keyboard<span class="token punctuation">.</span><span class="token function">pressed</span><span class="token punctuation">(</span><span class="token string">&quot;left&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span><span class="token function">translateX</span><span class="token punctuation">(</span><span class="token operator">-</span>moveDistance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>keyboard<span class="token punctuation">.</span><span class="token function">pressed</span><span class="token punctuation">(</span><span class="token string">&quot;right&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span><span class="token function">translateX</span><span class="token punctuation">(</span>moveDistance<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>keyboard<span class="token punctuation">.</span><span class="token function">pressed</span><span class="token punctuation">(</span><span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span><span class="token function">rotateOnAxis</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>keyboard<span class="token punctuation">.</span><span class="token function">pressed</span><span class="token punctuation">(</span><span class="token string">&quot;s&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span><span class="token function">rotateOnAxis</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span>rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>keyboard<span class="token punctuation">.</span><span class="token function">pressed</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span><span class="token function">rotateOnAxis</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>keyboard<span class="token punctuation">.</span><span class="token function">pressed</span><span class="token punctuation">(</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        box<span class="token punctuation">.</span><span class="token function">rotateOnAxis</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">-</span>rotateAngle<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> relativeCameraOffset <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> cameraOffset <span class="token operator">=</span> relativeCameraOffset<span class="token punctuation">.</span><span class="token function">applyMatrix4</span><span class="token punctuation">(</span> box<span class="token punctuation">.</span>matrixWorld <span class="token punctuation">)</span><span class="token punctuation">;</span>

    camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> cameraOffset<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
    camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> cameraOffset<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
    camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> cameraOffset<span class="token punctuation">.</span>z<span class="token punctuation">;</span>

    controls<span class="token punctuation">.</span>target <span class="token operator">=</span> box<span class="token punctuation">.</span>position<span class="token punctuation">;</span>

    controls<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span>

    window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>tick<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">tick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><p>扩展：人物如何和相机一起移动的？</p> <ul><li>camera.position.x = new THREE.Vector3(0, 5, 10).applyMatrix4( box.matrixWorld ).x;</li> <li>controls.target = box.position; -始终让控制器定位到物体</li></ul> <h2 id="_18-如何让带有动画的模型导入的动画运动起来"><a href="#_18-如何让带有动画的模型导入的动画运动起来" class="header-anchor">#</a> 18.如何让带有动画的模型导入的动画运动起来？</h2> <ul><li>加载模型—new THREE.FBXLoader().load</li> <li>找到可以动画的模型—const animationClip = obj.animations.find(animationClip =&gt; animationClip.name === &quot;mixamo.com&quot;);</li> <li>创建动画</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 动画  </span>
<span class="token keyword">var</span> animationMixer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AnimationMixer</span><span class="token punctuation">(</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>找到可以动画的模型名称设置加载速度播放</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 找到可以动画的模型名称</span>
<span class="token keyword">const</span> animationClip <span class="token operator">=</span> obj<span class="token punctuation">.</span>animations<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">animationClip</span> <span class="token operator">=&gt;</span> animationClip<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;mixamo.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> action2 <span class="token operator">=</span> animationMixer<span class="token punctuation">.</span><span class="token function">clipAction</span><span class="token punctuation">(</span>animationClip<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 7.5倍速度播放  </span>
action2<span class="token punctuation">.</span>timeScale <span class="token operator">=</span> <span class="token number">7.5</span><span class="token comment">//24帧每秒变为30帧每秒，要慢放为0.8倍，做动画要做30帧/s的</span>
<span class="token comment">//调用播放器的播放事件</span>
action2<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>循环播放调用更新</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 人物动画播放变化</span>
<span class="token keyword">const</span> clock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> delta <span class="token operator">=</span> clock<span class="token punctuation">.</span><span class="token function">getDelta</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">renderAnimate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token keyword">const</span> delta <span class="token operator">=</span> clock<span class="token punctuation">.</span><span class="token function">getDelta</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   animationMixer<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>delta<span class="token punctuation">)</span><span class="token punctuation">;</span>
   renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span>
   window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>renderAnimate<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">renderAnimate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_19-人物是如何转向的-在前后左右掉头的"><a href="#_19-人物是如何转向的-在前后左右掉头的" class="header-anchor">#</a> 19.人物是如何转向的，在前后左右掉头的？</h2> <ul><li>各个方向为不同的模型动画，当运动时，播放不同的模型动画</li></ul> <h2 id="_20-汽车开门-关门动画实现思路"><a href="#_20-汽车开门-关门动画实现思路" class="header-anchor">#</a> 20.汽车开门，关门动画实现思路</h2> <ul><li>开门：将状态置为开门—改变摄像机位置—让车门沿着y轴旋转90度—item.rotation.y - 0.5 * Math.PI</li> <li>关门：相机和地板位置置为起始位置—小车位置和旋转，视角变化—将状态置为关闭门—门的位置关闭恢复—item.rotation.y + 0.5 * Math.PI</li></ul> <h2 id="_21-模型加载慢-如何优化"><a href="#_21-模型加载慢-如何优化" class="header-anchor">#</a> 21.模型加载慢，如何优化？</h2> <ul><li>让模型师优化</li> <li>开发优化：无损压缩模型--压缩前131M,压缩后31M</li> <li>模型压缩一般有两种路线，一个是减小网格体的顶点和面数，一个是减小纹理材质的贴图</li> <li>gltf/glb 文件转换压缩上百M到十几M—https://zhuanlan.zhihu.com/p/48735094</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>步骤
npm i gltf<span class="token operator">-</span>pipeline
gltf<span class="token operator">-</span>pipeline <span class="token operator">-</span>i main1<span class="token punctuation">.</span>glb  <span class="token operator">-</span>o main2<span class="token punctuation">.</span>glb <span class="token operator">-</span>d
<span class="token operator">-</span>i<span class="token operator">:</span>输入
<span class="token operator">-</span>o<span class="token operator">:</span>输出
<span class="token operator">-</span>d<span class="token operator">:</span>draco压缩
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div></section> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/gaojieDoc/personal/personal.html" class="prev">
            个人作品
          </a></span> <span class="next"><a href="/gaojieDoc/webGL/3d.html">
            3d相关
          </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-cb1513f6><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_1-参数vertexshader和fragmentshader分别对应顶点着色器和片段着色器的内容-由glsl写成-区别" class="sidebar-link reco-side-_1-参数vertexshader和fragmentshader分别对应顶点着色器和片段着色器的内容-由glsl写成-区别" data-v-cb1513f6>1.参数vertexShader和fragmentShader分别对应顶点着色器和片段着色器的内容（由GLSL写成）区别？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_2-fbx模型里面有啥-模型是如何加载到网页并显示出来的" class="sidebar-link reco-side-_2-fbx模型里面有啥-模型是如何加载到网页并显示出来的" data-v-cb1513f6>2.fbx模型里面有啥？模型是如何加载到网页并显示出来的？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_3-如何让3d模型只能在上一半旋转" class="sidebar-link reco-side-_3-如何让3d模型只能在上一半旋转" data-v-cb1513f6>3.如何让3d模型只能在上一半旋转？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_4-加载3d的音频文件时-内容不显示" class="sidebar-link reco-side-_4-加载3d的音频文件时-内容不显示" data-v-cb1513f6>4.加载3d的音频文件时，内容不显示？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_5-3d的video没法播发http和m3u8-常见video解决方案" class="sidebar-link reco-side-_5-3d的video没法播发http和m3u8-常见video解决方案" data-v-cb1513f6>5.3d的video没法播发http和m3u8，常见video解决方案</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_6-3d的audio加载格式及问题" class="sidebar-link reco-side-_6-3d的audio加载格式及问题" data-v-cb1513f6>6.3d的audio加载格式及问题？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_7-audio让模型发声-远声音小-近声音大如何实现" class="sidebar-link reco-side-_7-audio让模型发声-远声音小-近声音大如何实现" data-v-cb1513f6>7.audio让模型发声，远声音小，近声音大如何实现？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_8-3d视频如何加载的" class="sidebar-link reco-side-_8-3d视频如何加载的" data-v-cb1513f6>8.3d视频如何加载的？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_9-常用2d和3d技术" class="sidebar-link reco-side-_9-常用2d和3d技术" data-v-cb1513f6>9.常用2d和3d技术</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_10-常见坐标系" class="sidebar-link reco-side-_10-常见坐标系" data-v-cb1513f6>10.常见坐标系</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_11-常见点位操作" class="sidebar-link reco-side-_11-常见点位操作" data-v-cb1513f6>11.常见点位操作</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_12-常用地图数据和3d模型处理工具" class="sidebar-link reco-side-_12-常用地图数据和3d模型处理工具" data-v-cb1513f6>12.常用地图数据和3d模型处理工具</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_13-模型来源" class="sidebar-link reco-side-_13-模型来源" data-v-cb1513f6>13.模型来源</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_14-3dtiles模型文件是怎么样的-模型是如何加载加载出来的" class="sidebar-link reco-side-_14-3dtiles模型文件是怎么样的-模型是如何加载加载出来的" data-v-cb1513f6>14.3dtiles模型文件是怎么样的？模型是如何加载加载出来的？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_15-导出瓦片文件指令是什么-常见配置项有那些" class="sidebar-link reco-side-_15-导出瓦片文件指令是什么-常见配置项有那些" data-v-cb1513f6>15.导出瓦片文件指令是什么？常见配置项有那些？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_16-第一人称和第三人称视角是什么-three中如何实现的" class="sidebar-link reco-side-_16-第一人称和第三人称视角是什么-three中如何实现的" data-v-cb1513f6>16.第一人称和第三人称视角是什么？three中如何实现的？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_17-人物移动如何实现" class="sidebar-link reco-side-_17-人物移动如何实现" data-v-cb1513f6>17.人物移动如何实现？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_18-如何让带有动画的模型导入的动画运动起来" class="sidebar-link reco-side-_18-如何让带有动画的模型导入的动画运动起来" data-v-cb1513f6>18.如何让带有动画的模型导入的动画运动起来？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_19-人物是如何转向的-在前后左右掉头的" class="sidebar-link reco-side-_19-人物是如何转向的-在前后左右掉头的" data-v-cb1513f6>19.人物是如何转向的，在前后左右掉头的？</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_20-汽车开门-关门动画实现思路" class="sidebar-link reco-side-_20-汽车开门-关门动画实现思路" data-v-cb1513f6>20.汽车开门，关门动画实现思路</a></li><li class="level-2" data-v-cb1513f6><a href="/gaojieDoc/webGL/webGL.html#_21-模型加载慢-如何优化" class="sidebar-link reco-side-_21-模型加载慢-如何优化" data-v-cb1513f6>21.模型加载慢，如何优化？</a></li></ul></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/gaojieDoc/assets/js/app.713b364e.js" defer></script><script src="/gaojieDoc/assets/js/3.cbaeffb4.js" defer></script><script src="/gaojieDoc/assets/js/1.790136b1.js" defer></script><script src="/gaojieDoc/assets/js/14.b3bbe717.js" defer></script>
  </body>
</html>
